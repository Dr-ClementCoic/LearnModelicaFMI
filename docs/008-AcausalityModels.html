<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>One model serves several purposes ‚Äì Modelica &amp; FMI</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7b1b06e26e1e2798ccde3208f86b5bbd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./002-Modelica101.html">Modelica</a></li><li class="breadcrumb-item"><a href="./008-AcausalityModels.html">One model serves several purposes</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelica &amp; FMI</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./001-Commitment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A bit of context</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Modelica</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./002-Modelica101.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modelica 101</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./003-FirstModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Your first Modelica model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./004-FirstSimulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Your first Modelica simulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./005-ModelRefactoring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Your first Modelica model refactoring</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./007-AcausalityEquation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acausality, the secret service of Modelica</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./008-AcausalityModels.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">One model serves several purposes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./009-NeedForDynamicSimulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The need for dynamic simulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./010-WhatDynamicSimulationDoes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What Dynamic Simulation Does?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./011-LetsIntegrate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Understand your model: let‚Äôs integrate!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./012-ReplaceableModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Choosing your Christmas gift!</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">FMI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./006-SpreadingWithFMI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spreading the word with FMI</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#starting-easy" id="toc-starting-easy" class="nav-link active" data-scroll-target="#starting-easy">Starting easy</a></li>
  <li><a href="#our-ideal-resistor-model" id="toc-our-ideal-resistor-model" class="nav-link" data-scroll-target="#our-ideal-resistor-model">Our ideal resistor model</a></li>
  <li><a href="#acausality-in-practice" id="toc-acausality-in-practice" class="nav-link" data-scroll-target="#acausality-in-practice">Acausality in practice</a></li>
  <li><a href="#bicausality-or-the-sizing-on-design-simulation" id="toc-bicausality-or-the-sizing-on-design-simulation" class="nav-link" data-scroll-target="#bicausality-or-the-sizing-on-design-simulation">Bicausality or the sizing / on-design simulation</a></li>
  <li><a href="#are-you-square" id="toc-are-you-square" class="nav-link" data-scroll-target="#are-you-square">Are you square?</a></li>
  <li><a href="#this-scales" id="toc-this-scales" class="nav-link" data-scroll-target="#this-scales">This scales!</a></li>
  <li><a href="#the-end-for-today" id="toc-the-end-for-today" class="nav-link" data-scroll-target="#the-end-for-today">The END for today</a></li>
  <li><a href="#bonus-resources-for-fast-learners" id="toc-bonus-resources-for-fast-learners" class="nav-link" data-scroll-target="#bonus-resources-for-fast-learners">Bonus: resources for fast learners</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./002-Modelica101.html">Modelica</a></li><li class="breadcrumb-item"><a href="./008-AcausalityModels.html">One model serves several purposes</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">One model serves several purposes</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./assets/images/008/01_header.png" class="img-fluid figure-img"></p>
<figcaption>Solving On-Design problems</figcaption>
</figure>
</div>
<p><em>I hope you‚Äôve got your preferred drink in hand</em> ‚òïÔ∏èü´ñüíß</p>
<p>Last week, we covered the basics of acausality:</p>
<blockquote class="blockquote">
<p>Acausality is the fact that equations are symbols and not assignments. So writing <code>V = R*i</code> or <code>i = V/R</code> or <code>V - R*i = 0</code> etc. makes no difference for an acausal model, because these are all equivalent. You write one model and the compiler will symbolically manipulate it in the form that is needed to solve your problem.</p>
</blockquote>
<p>A quote from‚Ä¶ me‚Ä¶ Not the best practice, I know‚Ä¶</p>
<p>Today, I want to show you in practice how this applies when you use a library of models. I mean, not when you code equations yourself, rather when you build model by composition (drag&amp;drop). And this scales well! Let‚Äôs dive in.</p>
<section id="starting-easy" class="level2">
<h2 class="anchored" data-anchor-id="starting-easy">Starting easy</h2>
<p>At school, when I was about 11years old, I had to ‚Äúplay‚Äù a lot with resistor. (I didn‚Äôt enjoy it much to be honest but‚Ä¶) Ohm‚Äôs law - <code>V = R*i</code> - got anchored in my brain‚Ä¶ I guess I am not the only one. So let‚Äôs take that as an example. It is easy and still illustrates our point quite well.</p>
</section>
<section id="our-ideal-resistor-model" class="level2">
<h2 class="anchored" data-anchor-id="our-ideal-resistor-model">Our ideal resistor model</h2>
<p>I made an ideal resistor model. It just does Ohm‚Äôs law. Almost:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./assets/images/008/02_ohmsLaw.png" class="img-fluid figure-img"></p>
<figcaption>Model of our ideal resistor, implementing Ohm‚Äôs law.</figcaption>
</figure>
</div>
<p>We have not seen much of the Modelica language so far. So let me paraphrase the code: - this <code>IdealResistor</code> has the same interfaces than a <code>OnePort</code> model. The one port model has two electrical pins and defines the voltage difference between the two pins as <code>V</code> and the current entering the component from the blue pin as positive. - I declared a parameter <code>R</code> of type <code>Resistance</code> so that it also gets the unit <code>[Ohm]</code> and assigned a start value of <code>1 Ohm</code>. Why a start value? You‚Äôll soon see. For now, it is enough to say that: 1. if you give the parameter a value, then this start value is not used, and 2. 2. if you don‚Äôt provide a value while it is needed, then most compiler will use the start value as parameter value (and raise a warning). - The very famous Ohm‚Äôs law is simply written as equation: <code>V=R*i</code>.</p>
<p>Of course, there is a resistor model in the <strong><em>M</em></strong>odelica <strong><em>S</em></strong>tandard <strong><em>L</em></strong>ibrary (keep in mind, we call it <strong><em>MSL</em></strong>, and I‚Äôll soon just use only MSL because I am lazy) - check it out: <code>Modelica.Electrical.Analog.Basic.Resistor</code>. However, it also does more than just Ohm‚Äôs law, as it computes the dissipated power and can also include the resistance dependency on temperature. That is great, but for our example, it will just clutter our scope.</p>
</section>
<section id="acausality-in-practice" class="level2">
<h2 class="anchored" data-anchor-id="acausality-in-practice">Acausality in practice</h2>
<p>I claimed in <a href="./007-AcausalityEquation.html">the previous article</a>, and somehow in the above quote, that the compiler will turn around Ohm‚Äôs law based on the known variable to solve for the other. Let‚Äôs prove it!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./assets/images/008/03_acausalResistor.png" class="img-fluid figure-img"></p>
<figcaption>Same resistor model used in resistance and conductance causalities.</figcaption>
</figure>
</div>
<p>We set up two examples, both with a resistance value of 21 Ohm. This is a silly value but I don‚Äôt mind, I know the universal answer is 42, and this model gets to it‚Ä¶ Where was I, ah yes: two examples. - On the left side, we specify that the current that enters the resistor is 2A. Ohm‚Äôs law tells us that the voltage <code>V</code> should be equal to <code>R*i=21*2=42V</code>! The universal answer! And that is what our simulation says! - On the right side, we specify that the voltage is 42. We want to prove that the model will be turned around and give us the same current <code>i</code> as on the left side: <code>i=V/R=42/21=2A</code>. Done!</p>
<p>One model, two purposes! And it is not over!</p>
</section>
<section id="bicausality-or-the-sizing-on-design-simulation" class="level2">
<h2 class="anchored" data-anchor-id="bicausality-or-the-sizing-on-design-simulation">Bicausality or the sizing / on-design simulation</h2>
<p>Remember how last week we could use our same equation to calculate the parameter value (the area of the runner)? Here we can also use the model to define the value of the ideal resistor. We just need to take one of the two examples and specify the value of the missing variable at initial time. So let‚Äôs take the right example and say that the initial current is 4A. We call that bicausality - because both causality are specified - or sizing - because we size the resistor‚Äôs resistance - or on-design simulation - because we solve a design problem. (Just in case you face these words in the future.)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./assets/images/008/04_bicausalityResistor.png" class="img-fluid figure-img"></p>
<figcaption>Finding the resistance value based on initial conditions and running the simulation maintaining this value.</figcaption>
</figure>
</div>
<p>Before claiming ‚ÄúHooray!‚Äù, I need to pause for a few of explanations: - Why did I change the constant voltage source to a signal voltage source? I could have kept the constant source, but then we would not have observed the fact that the resistance is only computed once (at initial time) and then used as a fixed value for the rest of the simulation. See how the two lines on the right keep the same ratio? So I just chose to specify the voltage to be <code>42*(1+time)</code> so that at the beginning of the simulation (I set the initial time to be 0), the voltage is 42V and after that it increases by 42V every second (crazy! but again, we don‚Äôt mind here). - Where do we specify the initial current? In the code, we just added <code>resistor.i = 4;</code> as <code>initial equation</code> and that does exactly that. It adds an initial equation to our system, saying that the current through the resistor is 4A - only at that initial time. - Are we really computing the value of the resistance? Yes! See how the icon of the resistor says <code>R =</code>, nothing. Blank. No value. We do not specify the resistance value. It is solved at initial time. - At initial time? ü§î When you compile a Modelica model, there are actually TWO models being created. The first one is the initialization problem: it solves the initial conditions of your system - and as in this case the unknown parameters. The second is the time simulation problem: the one everyone thinks about - computing the time trajectories of all time variables.</p>
<p>Hooray! It worked!</p>
</section>
<section id="are-you-square" class="level2">
<h2 class="anchored" data-anchor-id="are-you-square">Are you square?</h2>
<p>Not you. The system of equations. This is something you might remember from school, and it is so important when developing models that I am keen to revisit the topic here.</p>
<p>Starting small: if you have one (1) equation with several variables - again, let‚Äôs take <code>V = R*i</code> - how many unknown variables can there be in this equation? Only one (1) variable, right? All the others need to be known! Changing the viewpoint, if you have three (3) unknown variables, you need three (3) equations.</p>
<p>You see how the number of equations shall equal the number of variables, for your system to be solvable. That is what is called a square system, because if you write the equations as rows and the variables as columns, you end up with a square (matrix).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./assets/images/008/05_bltResistor.png" class="img-fluid figure-img"></p>
<figcaption>The solving of the resistor equations for the three examples above</figcaption>
</figure>
</div>
<p>In the first example (left), we knew i and R and solved Ohm‚Äôs law for V. In the second example (middle), we knew V and R and solved Ohm‚Äôs law for i. And lastly, we could find the value of R by solving Ohm‚Äôs law in the initialization problem, knowing i0 and V0.</p>
<p>A couple of notes: - It is obviously important that the equations you have are independent! If your equations are <code>i=42</code>, <code>V=R*i</code> and <code>i=V/R</code>, that won‚Äôt make it‚Ä¶ because the two last ones are equivalent. - Now it might make sense why we had to add an initial equation for i on our on-design example: the value of R is unknown and needs to be solved from Ohm‚Äôs law at initialization. The value of V is known because at time = 0, its equation gave V=42. We needed to specify i, and we needed to specify it ONLY at initialization because as soon as the initialization problem is solved, the value of R is known (R is still a parameter, its value do not change during simulation!), V is known and so the third equation (Ohm‚Äôs law) needs to be solved for the current i.</p>
<p>That was a lot! Let‚Äôs show a nice example and wrap up for today!</p>
</section>
<section id="this-scales" class="level2">
<h2 class="anchored" data-anchor-id="this-scales">This scales!</h2>
<p>Imagine you are an aircraft designer. Imagine you want to electrify an aircraft. So you decide to add an electrical generator to the gas turbine, to generate electricity, store it in batteries and then reuse it when needed to provide propulsion through electrical propellers. Good idea! Actually not your idea, but a good one. üòâ</p>
<p>What happens however is that the electrical component generate heat and this heat needs to be evacuated. So you have to design a cooling system that goes and ‚Äúcollect‚Äù the heat from the electrical components for them to operate at reasonable temperatures.</p>
<blockquote class="blockquote">
<p>A flow balancing problem consists of sizing restrictions on flow branches of a fluid system to match desired flow rates on each branch. The problem is rarely trivial as parallel branches routinely contain many components with nonlinear pressure loss characteristics each.</p>
</blockquote>
<p>Again, self-quoting‚Ä¶ but I was not alone this time! Check <a href="https://ecp.ep.liu.se/index.php/modelica/article/view/557/527">the paper</a> if interested! And shout out to <a href="https://www.linkedin.com/in/daniel-andersson-91149522/">Daniel Andersson</a>, <a href="https://www.linkedin.com/in/nirmala-nirmala/">Nirmala</a>, and <a href="https://www.linkedin.com/in/michael-sielemann-3b05a52/">Michael Sielemann</a> for co-authoring this one üôÇ</p>
<p>We used the same trick as for sizing the resistor. But we did it three times and on a larger system! It could have been more times and a larger system‚Ä¶ this one was just meaningfully representing our system under study.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./assets/images/008/06_sizingOrifice.png" class="img-fluid figure-img"></p>
<figcaption>The orifice sizing is very similar to the resistor sizing problem</figcaption>
</figure>
</div>
<p>In the case of the orifice, we expect the pressures to be known at both sides and thus we additionally allow for specifying the initial mass flow rate in sizing mode.</p>
<p>On the overall system (below), we have three of such orifices (on the upper part of each branch) and they are meant to be sized to evacuate the right amount of heat coming from the ‚Äúfire / exploding / red crown‚Äù components that represent heat sources.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./assets/images/008/07_flowBalancing.jpeg" class="img-fluid figure-img"></p>
<figcaption>Solving a flow balancing problem: sizing the orifices to evacuate the specified amount of heat</figcaption>
</figure>
</div>
<p>Now if you remember, we should have a square system. I let you write the equations and verify whether that is true, ‚Äúas an exercise‚Äù. Yeah, no, thanks! You might just want to trust me on this one üòÖ But just for the feeling, you can think of it as: you specify some values for the orifices, the simulation runs, that means that the system is square. Now you convert three <code>(-3)</code> parameters (the orifices‚Äô diameter) into unknowns for the initialization problem, that means that you need to add three <code>(+3)</code> initial equations for this to be square, and these are the initial mass flow rate specified at the orifice level. So we should stay square. üôÇ</p>
</section>
<section id="the-end-for-today" class="level2">
<h2 class="anchored" data-anchor-id="the-end-for-today">The END for today</h2>
<p>Enough for today. I hope you enjoyed this other perspective on acausality. Next time, we will see a different topic. (Suspense!)</p>
<p><em>Break is over, go back to what you were doing.</em></p>
<p>Cl√©ment</p>
<p><a href="./009-NeedForDynamicSimulation.html">Next</a> -&gt;</p>
</section>
<section id="bonus-resources-for-fast-learners" class="level2">
<h2 class="anchored" data-anchor-id="bonus-resources-for-fast-learners">Bonus: resources for fast learners</h2>
<ul>
<li><a href="https://www.linkedin.com/posts/clementcoic_drccdontconfuse-activity-7269254826260115457-Ois8">Don‚Äôt confuse causal/acausal modeling with block diagram/component-based modeling</a></li>
<li><a href="https://www.linkedin.com/posts/clementcoic_drccacausalitymodelica-activity-7273241095151452160-BStr">Acausality with Modelica explained</a></li>
<li><a href="https://www.linkedin.com/posts/clementcoic_%F0%9D%97%A6%F0%9D%97%BC%F0%9D%97%B9%F0%9D%98%83%F0%9D%97%B6%F0%9D%97%BB%F0%9D%97%B4-%F0%9D%97%AE-%F0%9D%97%BF%F0%9D%97%B2%F0%9D%97%AE%F0%9D%97%B9-%F0%9D%97%B2%F0%9D%97%BB%F0%9D%97%B4%F0%9D%97%B6%F0%9D%97%BB%F0%9D%97%B2%F0%9D%97%B2-activity-7284857639807705089-hdZU">Solving a real engineering design problem with simulation</a></li>
<li><a href="https://ecp.ep.liu.se/index.php/modelica/article/view/557/527">The On-Design paper for Thermal Management System</a></li>
</ul>


</section>

<p>¬© 2025 Cl√©ment Co√Øc ‚Äî Licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0/">creative commons 4.0</a>. Non-commercial use only.</p></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>