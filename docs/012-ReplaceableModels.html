<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Choosing your Christmas gifts! ‚Äì Modelica &amp; FMI</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7b1b06e26e1e2798ccde3208f86b5bbd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./002-Modelica101.html">Modelica</a></li><li class="breadcrumb-item"><a href="./012-ReplaceableModels.html">Choosing your Christmas gift!</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelica &amp; FMI</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./001-Commitment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A bit of context</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Modelica</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./002-Modelica101.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modelica 101</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./003-FirstModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Your first Modelica model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./004-FirstSimulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Your first Modelica simulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./005-ModelRefactoring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Your first Modelica model refactoring</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./007-AcausalityEquation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acausality, the secret service of Modelica</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./008-AcausalityModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">One model serves several purposes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./009-NeedForDynamicSimulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The need for dynamic simulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./010-WhatDynamicSimulationDoes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What Dynamic Simulation Does?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./011-LetsIntegrate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Understand your model: let‚Äôs integrate!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./012-ReplaceableModels.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Choosing your Christmas gift!</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">FMI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./006-SpreadingWithFMI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spreading the word with FMI</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-if-i-have-several-presents-in-mind" id="toc-what-if-i-have-several-presents-in-mind" class="nav-link active" data-scroll-target="#what-if-i-have-several-presents-in-mind">What if I have several presents in mind?</a>
  <ul class="collapse">
  <li><a href="#a-pool-of-options" id="toc-a-pool-of-options" class="nav-link" data-scroll-target="#a-pool-of-options">A pool of options</a></li>
  <li><a href="#constraining-our-gifts" id="toc-constraining-our-gifts" class="nav-link" data-scroll-target="#constraining-our-gifts">Constraining our gifts</a></li>
  <li><a href="#we-can-do-it-digitally" id="toc-we-can-do-it-digitally" class="nav-link" data-scroll-target="#we-can-do-it-digitally">We can do it digitally!</a></li>
  </ul></li>
  <li><a href="#the-modelica-concepts-you-need-today" id="toc-the-modelica-concepts-you-need-today" class="nav-link" data-scroll-target="#the-modelica-concepts-you-need-today">The Modelica concepts you need today</a>
  <ul class="collapse">
  <li><a href="#extends" id="toc-extends" class="nav-link" data-scroll-target="#extends">extends</a></li>
  <li><a href="#replaceable" id="toc-replaceable" class="nav-link" data-scroll-target="#replaceable">replaceable</a></li>
  </ul></li>
  <li><a href="#the-perfect-christmas-model" id="toc-the-perfect-christmas-model" class="nav-link" data-scroll-target="#the-perfect-christmas-model">The perfect Christmas model</a></li>
  <li><a href="#but-what-can-i-do-with-that" id="toc-but-what-can-i-do-with-that" class="nav-link" data-scroll-target="#but-what-can-i-do-with-that">But what can I do with that?</a></li>
  <li><a href="#the-end-for-today" id="toc-the-end-for-today" class="nav-link" data-scroll-target="#the-end-for-today">The END for today</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./002-Modelica101.html">Modelica</a></li><li class="breadcrumb-item"><a href="./012-ReplaceableModels.html">Choosing your Christmas gift!</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Choosing your Christmas gifts!</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./assets/images/012/01_header.png" class="img-fluid figure-img"></p>
<figcaption>Making sure everyone is happy!</figcaption>
</figure>
</div>
<p><em>I hope you‚Äôve got your preferred drink in hand</em> ‚òïÔ∏èü´ñüíß</p>
<p>üì¨ üì∞ <strong>Saturday editions</strong> - for having more time to read during the weekend! Let‚Äôs experiment for a few weeks. Let me know if this is not a convenient day (‚ùì).</p>
<p>Thanksgiving is behind US (pun intended) and Christmas is in the mind of many. In Europe, it is a great deal: lights all around, Christmas market, and obviously‚Ä¶ shopping for gifts!<br>
To me, it is not the best part. What presents should I choose?</p>
<p>Well, today we will show that Modelica has a great solution for that.<br>
Let‚Äôs dig into it!</p>
<section id="what-if-i-have-several-presents-in-mind" class="level2">
<h2 class="anchored" data-anchor-id="what-if-i-have-several-presents-in-mind">What if I have several presents in mind?</h2>
<section id="a-pool-of-options" class="level3">
<h3 class="anchored" data-anchor-id="a-pool-of-options">A pool of options</h3>
<p>You know your loved ones the best. This does not mean you can read their minds. You might have heard them saying they‚Äôd like to visit this destination nearby or try this new activity. Maybe you think they would love this new book or taking a course about Indian food cooking, etc.<br>
<em>(In case you did not notice, I am trying to give you ideas for those who are still looking for gifts! Personally, I am‚Ä¶!)</em></p>
<p>So you end up with a list of names and gifts. Some gifts can be for several persons but not all.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Partner</th>
<th style="text-align: center;">Kids</th>
<th style="text-align: center;">Parents</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Love letter</td>
<td style="text-align: center;">Toy</td>
<td style="text-align: center;">Book</td>
</tr>
<tr class="even">
<td style="text-align: center;">Cooking course</td>
<td style="text-align: center;">Amusement Park</td>
<td style="text-align: center;">Tea &amp; Coffee</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Book</td>
<td style="text-align: center;">Bike üö≤</td>
<td style="text-align: center;">Cooking course</td>
</tr>
<tr class="even">
<td style="text-align: center;">Bike üö≤</td>
<td style="text-align: center;">Guitar</td>
<td style="text-align: center;">Wine</td>
</tr>
</tbody>
</table>
<p>We see that some gifts could be for different persons. You might really like this book and want to give it to both your partner and your parents. Or both your partner and kids need a new bike!<br>
So you could just put all the gifts in a room and let them pick the preferred option, or?</p>
<p>But NO!! You don‚Äôt want your parents to receive the love letter üíå you wrote for your second half üò± !! We need to solve that.</p>
</section>
<section id="constraining-our-gifts" class="level3">
<h3 class="anchored" data-anchor-id="constraining-our-gifts">Constraining our gifts</h3>
<p>Let‚Äôs brainstorm an idea.<br>
What we really need is that each of them get a gift, and when they open the present, they can choose any item from their list on the table. But only those in their column‚Ä¶ The parents would not get the <code>Love Letter</code> option.</p>
<blockquote class="blockquote">
<p>Now, between us, write a love letter to your parents or a gratitude letter, and that would be the best gift they could get‚Ä¶ Well, depends on the parents‚Ä¶ Back to our point.</p>
</blockquote>
<p>You end up with the following mapping - which is just the table:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./assets/images/012/02_giftMapping.png" class="img-fluid figure-img"></p>
<figcaption>The perfect gift mapping</figcaption>
</figure>
</div>
<p>And so the game is simple: only the relevant person can access its box, follow the lines and pick one present.<br>
Now we made sure that the <code>Love Letter</code> will only reach our partner. ü§≠.<br>
(<em>Well not ‚ÄúOUR‚Äù partner‚Ä¶ our respective partners, eh!</em>)</p>
<p>Unfortunately, there is a small glitch in the plan: we cannot fit all the items within the gift boxes physically!</p>
</section>
<section id="we-can-do-it-digitally" class="level3">
<h3 class="anchored" data-anchor-id="we-can-do-it-digitally">We can do it digitally!</h3>
<p>So we decide to develop a Modelica model of course!<br>
We want the model to do exactly that: display only the relevant options to the relevant persons. Then we would just open our preferred Modelica tool with this model and let them chose in a menu that only allows for their potential gifts!</p>
<p>And here is a thing: it is possible!<br>
We just need to understand two keywords: <code>extends</code> and <code>replaceable</code>.</p>
</section>
</section>
<section id="the-modelica-concepts-you-need-today" class="level2">
<h2 class="anchored" data-anchor-id="the-modelica-concepts-you-need-today">The Modelica concepts you need today</h2>
<p>I will try to demystify these two words for you in a few sentences. Of course, to do so, I take some shortcuts. But shortcuts is what allow us to move faster :)</p>
<section id="extends" class="level3">
<h3 class="anchored" data-anchor-id="extends">extends</h3>
<p>Modelica is an object-oriented modeling language. It means that everything is an ‚Äúobject‚Äù: a <code>model</code> for example, or a <code>connector</code>, or <code>Real</code> (is a <code>type</code>, which in the end is an ‚Äúobject‚Äù too).<br>
Yes, <code>Real</code>! You remember we used it at some point?</p>
<p>There are two main ways to use an ‚Äúobject‚Äù:</p>
<ol type="1">
<li>we can instantiate it. This means that we ‚Äúuse it‚Äù in our model. And by that I mean that in our model, we will have this object one or several times and we can only modify some defined parameters or so. In the end, these are ‚Äúpointers‚Äù to the real object in your library. Changing the object in the library will change the ‚Äúinstances‚Äù in your model. This way, you can build up an electrical circuit using several <code>Resistor</code> from MSL - they all point to the same <code>Resistor</code> in the library -, and if we add new capabilities in this <code>Resistor</code> model, then you‚Äôll have them also.</li>
<li>we can inherit it. This means that we ‚Äúget all the code‚Äù of the ‚Äúobject‚Äù in our model. We don‚Äôt get the object itself, only the code it contains. So if you create ‚ÄúMyResistor‚Äù that inherit from the <code>Resistor</code> of MSL, then you won‚Äôt get to recode all these lines nor the icon, they will ‚Äúcome‚Äù automatically. And <code>extends</code> is the keyword to use to inherit from another model.</li>
</ol>
<p>So if I write:</p>
<pre><code>model Coffee
  extends Drinks;
end Coffee;</code></pre>
<p>Then we know that the <code>Coffee</code> will get all the code from our <code>Drinks</code>.</p>
</section>
<section id="replaceable" class="level3">
<h3 class="anchored" data-anchor-id="replaceable">replaceable</h3>
<p>Here is a fun one: <code>replaceable</code> allows you to specify that an instance (remember point 1. from above?) is actually just a ‚Äúplaceholder‚Äù and needs to be <code>redeclared</code> by a matching option.</p>
<p>We can constrain the choices for the replaceable model in different ways. The way we are discussing today is simple: automatically, all <strong>objects</strong> that <strong>inherit</strong> your model that is replaceable are candidates for its replacement!</p>
<p>So if I write:</p>
<pre><code>model Breakfast
    replaceable Drinks morningDrink "My preferred breakfast drink";
end Breakfast;</code></pre>
<p>Then I will see <code>Coffee</code> as an option on the list of choices!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./assets/images/012/03_breakfastDrink.png" class="img-fluid figure-img"></p>
<figcaption>You can redeclare your Drink as Coffee because it extends Drinks</figcaption>
</figure>
</div>
<p>Things start to make sense now for our Christmas gift story?</p>
</section>
</section>
<section id="the-perfect-christmas-model" class="level2">
<h2 class="anchored" data-anchor-id="the-perfect-christmas-model">The perfect Christmas model</h2>
<p>Let‚Äôs wrap up our gift story.<br>
We built the perfect model for our Christmas and here it is!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./assets/images/012/04_christmasApp.png" class="img-fluid figure-img"></p>
<figcaption>Our Christmas App - demoing Kids‚Äô choices</figcaption>
</figure>
</div>
<p>And the crazy part is that, apart from some annotations and the Gift models I created, the model is simply:</p>
<pre><code>model Christmas "The recipe for a happy Christmas"
    .ModelicaNewsletter.Replaceable.ChristmasTree christmasTree ;
    replaceable .ModelicaNewsletter.Replaceable.Receivers.Partner partnerGift "Your partner can choose their gift from the list";
    replaceable .ModelicaNewsletter.Replaceable.Receivers.Parents parents "Your parents can choose their gift from the list";
    replaceable .ModelicaNewsletter.Replaceable.Receivers.Kids kids "Your kids can choose their gift from the list" ;
end Christmas;</code></pre>
<p>How powerful is that?<br>
Seems like Christmas magic to me! Only you can have Christmas all year long with Modelica üòâ</p>
</section>
<section id="but-what-can-i-do-with-that" class="level2">
<h2 class="anchored" data-anchor-id="but-what-can-i-do-with-that">But what can I do with that?</h2>
<p>OK, OK, you might not really have a <code>Breakfast</code> model nor <code>Christmas</code> model use case‚Ä¶ but there are plenty of great application to leverage this.</p>
<p>Everywhere you can decompose your system into subsystems, then it can be done this way. Imagine an aircraft landing gear, that carries the aircraft, the wheels, the brakes:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./assets/images/012/05_landingGear.png" class="img-fluid figure-img"></p>
<figcaption>Model of an aircraft landing gear - from Modelon</figcaption>
</figure>
</div>
<p>The same could be done for a ground vehicle (e.g.&nbsp;car) where you have the chassis, the wheels, the driver, the road, etc.</p>
<p>But you could just also do that to make <strong>replaceable</strong> a function in your model. Let‚Äôs say you have a <code>Friction</code> model and you want to give the user the choice to select a <code>CoulombFriction</code> or <code>ViscousFriction</code>, then you can use this construct and achieve the desired goal!</p>
</section>
<section id="the-end-for-today" class="level2">
<h2 class="anchored" data-anchor-id="the-end-for-today">The END for today</h2>
<p>Enough for today. I hope you learned something and enjoyed the Christmas story! This is a great transition to let you know that I will soon take some Christmas vacations. So maybe a couple more articles this year are to be expected‚Ä¶ and a longer break will come üòä<br>
Letting you time to review the past ones? üòâ</p>
<p><em>Break is over, go back to what you were doing.</em></p>
<p>Clem</p>
<p><a href="./about.html">Next</a> -&gt;</p>


</section>

<p>¬© 2025 Cl√©ment Co√Øc ‚Äî Licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0/">creative commons 4.0</a>. Non-commercial use only.</p></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>